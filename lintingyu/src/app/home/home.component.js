"use strict";var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),__decorate=this&&this.__decorate||function(t,e,n,i){var o,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var r=t.length-1;0<=r;r--)(o=t[r])&&(s=(a<3?o(s):3<a?o(e,n,s):o(e,n))||s);return 3<a&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),page_component_1=require("../pageBase/page.component"),canvas_drow_1=require("../component/canvas/canvas-drow"),app_data_canvas_const_1=require("../data/app-data-canvas.const"),HomeComponent=function(a){function t(t,e,n,i){var o=a.call(this)||this;return o.el=t,o.canvasEvent=e,o.toolFn=n,o.anFrame=i,o.canvasSize={width:0,height:0},o.canvasAllRadey=!1,o.originalW=280,o.originalH=150,o.aspectRatio=o.originalW/o.originalH,o.ineerCtxPos={x:0,y:0},o.transform={scale:4,translate:{x:500,y:400}},o.spring=.2,o.friction=.9,o.speed=1,o.linePower=5e3,o.fillPower=3e3,o.linFillData=app_data_canvas_const_1.linFillData,o.fillDotVector=null,o.linStrokeData=app_data_canvas_const_1.linStrokeData,o.strokeDotVector=null,o.itemlist=3,o.active=0,o}return __extends(t,a),t.prototype.onListChange=function(t){0===(this.active=t)?(this.spring=.2,this.friction=.9,this.speed=1):1===t?(this.spring=.2,this.friction=.9,this.speed=.01):2===t&&(this.spring=.4,this.friction=.99,this.speed=1.5),this.setSpringFrictionSpeed(this.fillDotVector),this.setSpringFrictionSpeed(this.strokeDotVector)},t.prototype.mouseMove=function(t){this.toolFn.DETECTOR.isDesktopDevice&&this.canvasAllRadey&&(this.canvasEvent.targetPos.top<0&&this.canvasEvent.setTargetPos(this.canvasDOM),this.ineerCtxPos=this.canvasEvent.bindingMouseMove(t))},t.prototype.mouseDown=function(t){this.toolFn.DETECTOR.isDesktopDevice?(this.linePower=2e4,this.fillPower=1e4):(this.canvasEvent.targetPos.top<0&&this.canvasEvent.setTargetPos(this.canvasDOM),this.ineerCtxPos=this.canvasEvent.bindingMouseMove(t))},t.prototype.mouseUp=function(t){this.toolFn.DETECTOR.isDesktopDevice?(this.linePower=5e3,this.fillPower=3e3):this.ineerCtxPos={x:-999,y:-999}},t.prototype.onResize=function(t){this.setCanvasSize(t.target.innerWidth,t.target.innerHeight),this.calculateTransform(),this.dotsTransform()},t.prototype.calculateTransform=function(){if(768<this.canvasSize.width){var t=.65*this.canvasSize.width/this.originalW,e=1920<=this.canvasSize.width?80:60;.625<t*this.originalH/this.canvasSize.height&&(t=.625*this.canvasSize.height/this.originalH),this.transform.scale=t,this.transform.translate.x=.87*this.canvasSize.width-t*this.originalW,this.transform.translate.y=this.canvasSize.height-e-t*this.originalH}else{.3<(t=(this.canvasSize.width-50)/this.originalW)*this.originalH/this.canvasSize.height&&(t=.3*this.canvasSize.height/this.originalH),this.transform.scale=t,this.transform.translate.x=(this.canvasSize.width-t*this.originalW)/2,this.transform.translate.y=this.canvasSize.height-120-t*this.originalH}},t.prototype.dotsTransform=function(){var e=this;this.fillDotVector.forEach(function(t){t.forEach(function(t){t.transform(e.transform.scale,e.transform.translate.x,e.transform.translate.y)})}),this.strokeDotVector.forEach(function(t){t.forEach(function(t){t.transform(e.transform.scale,e.transform.translate.x,e.transform.translate.y)})})},t.prototype.setSpringFrictionSpeed=function(t){var e=this;t.forEach(function(t){t.forEach(function(t){t.spring=e.spring,t.friction=e.friction,t.speed=e.speed})})},t.prototype.drowCanvas=function(){var n=this;this.fillDotVector.forEach(function(t){t.forEach(function(t){var e=n.canvasEvent.dotInteractive(t,n.ineerCtxPos,n.fillPower,!1);t.moveTo(e)}),n.canvasEvent.dorwPath(n.ctx,t,!0,{drowFill:!0,fillStyle:"rgba(115, 242, 141, 0.6)"})}),this.strokeDotVector.forEach(function(t){t.forEach(function(t){var e=n.canvasEvent.dotInteractive(t,n.ineerCtxPos,n.linePower);t.moveTo(e)}),n.canvasEvent.dorwPath(n.ctx,t,!1,{drowStroke:!0})})},t.prototype.setCanvasSize=function(t,e){this.canvasSize.width=t,this.canvasSize.height=e},t.prototype.setId=function(){this.id="canvas-id-"+(new Date).getTime()},t.prototype.getCanvasDOM=function(){this.canvasDOM=this.el.nativeElement.querySelector("#"+this.id)},t.prototype.dataToVector=function(t){var e=this;return t.map(function(t){return t.map(function(t){return new canvas_drow_1.Vector(t[0],t[1],e.spring,e.friction)})})},t.prototype.linDataDotInit=function(){this.fillDotVector=this.dataToVector(this.linFillData),this.strokeDotVector=this.dataToVector(this.linStrokeData)},t.prototype.afterGetCanvasDOM=function(){var t=this;this.ctx=this.canvasDOM.getContext("2d"),this.canvasEvent.setTargetPos(this.canvasDOM),this.canvasAllRadey=!0,this.anFrame.bindingAniamtionFrame(function(){t.ctx.clearRect(0,0,t.canvasSize.width,t.canvasSize.height),t.drowCanvas()}),this.anFrame.startAniamtionFrame()},t.prototype.ngOnInit=function(){this.setId(),this.setCanvasSize(window.innerWidth,window.innerHeight),this.linDataDotInit(),this.calculateTransform(),this.dotsTransform(),document.body.style.overflow="hidden"},t.prototype.ngAfterViewInit=function(){var t=this;this.getCanvasDOM(),this.toolFn.reCheck(this,function(){return t.canvasDOM},this.afterGetCanvasDOM)},t.prototype.ngOnDestroy=function(){this.anFrame.unbindingAniamtionFrame(),document.body.style.overflow=""},__decorate([core_1.HostListener("window:resize",["$event"])],t.prototype,"onResize",null),t=__decorate([core_1.Component({selector:"app-home",templateUrl:"./home.component.html",styleUrls:["./home.component.scss"]})],t)}(page_component_1.PageComponent);exports.HomeComponent=HomeComponent;